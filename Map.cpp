#include <iostream>
#include "Map.h"

MainMap::MainMap()
    : StartMap{
        {219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219},
        {219,32, 32, 32, 32, 32, 219,32, 32, 32, 32, 32, 32, 32, 32, 219,219,219,219,219,32, 32, 32, 32, 32, 32, 32, 32, 32, 219},
        {219,32, 219,219,32, 32, 219,219,219,32, 32, 32, 219,219,219,219,32, 32, 32, 219,32, 32, 32, 32, 32, 32, 32, 32, 32, 219},
        {219,32, 32, 219,32, 32, 219,32, 32, 32, 32, 32, 32, 32, 32, 219,32, 32, 32, 219,32, 32, 32, 32, 32, 32, 32, 32, 32, 219},
        {219,32, 32, 32, 219,32, 32, 32, 32, 32, 32, 32, 219,32, 32, 32, 32, 219,32, 32, 32, 219,219,219,32, 32, 32, 32, 32, 219},
        {219,32, 32, 32, 219,32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 219,219,219,219,219,32, 219,219,32, 32, 32, 32, 219},
        {219,32, 219,32, 219,219,219,219,219,32, 32, 32, 219,219,219,219,32, 219,32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 219},
        {219,32, 219,219,219,219,219,219,219,219,32, 32, 32, 32, 219,219,32, 219,219,32, 32, 219,32, 32, 219,219,219,219,32, 219},
        {219,32, 32, 219,32, 32, 32, 32, 32, 219,32, 32, 32, 32, 219,32, 32, 32, 219,32, 32, 219,32, 32, 32, 32, 32, 219,32, 219},
        {219,32, 32, 32, 32, 219,32, 32, 32, 219,32, 32, 32, 32, 219,32, 32, 32, 219,32, 32, 32, 32, 32, 32, 32, 32, 219,32, 219},
        {219,219,219,219,219,219,219,219,32, 219,32, 219,219,219,219,32, 32, 32, 219,32, 32, 219,219,219,219,219,219,219,219,219},
        {219,32, 32, 219,32, 32, 32, 32, 32, 219,219,219,219,32, 32, 32, 32, 32, 219,32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 219},
        {219,32, 32, 219,219,32, 219,219,219,32, 32, 32, 219,32, 219,219,219,32, 219,219,32, 219,219,219,32, 32, 32, 32, 32, 219},
        {219,32, 32, 219,32, 32, 219,32, 219,32, 219,219,219,32, 219,32, 32, 32, 219,32, 32, 32, 32, 219,32, 32, 32, 32, 32, 219},
        {219,32, 32, 219,32, 32, 219,32, 32, 32, 219,32, 32, 32, 219,32, 219,32, 219,32, 32, 32, 32, 219,32, 32, 32, 32, 32, 219},
        {219,32, 32, 32, 32, 219,219,32, 32, 32, 219,32, 32, 219,219,219,219,32, 219,32, 32, 32, 219,219,32, 32, 32, 32, 32, 219},
        {219,32, 32, 219,32, 219,32, 32, 32, 32, 219,32, 32, 219,32, 32, 32, 32, 219,219,219,219,219,32, 32, 32, 32, 219,32, 219},
        {32, 32, 219,219,219,219,32, 32, 32, 32, 219,219,219,219,32, 32, 32, 32, 32, 32, 32, 32, 219,219,219,219,219,219,32, 32},
        {219,32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 219,32, 219},
        {219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219,219}
    }
{}

void MainMap::DrawMap()
{
   	system("cls");
   	std::cout << "Current position: X = " << player.getX() << " Y = " << player.getY() << std::endl;
   	Map[player.getX()][player.getY()] = 64;
   	if (!player.bull.empty())
   	{
   		for (Bullet* obj:player.bull){
   			if (obj->getX() < 19 && obj->getY() < 29){
   				Map[obj->getX()][obj->getY()] = Map[obj->getX()][obj->getY()] == 219 ? 32 : 45;
   				Map[obj->getX()][obj->getY()-1] =  32;
   				obj->setY(obj->getY()+1);
   			} else
   				Map[obj->getX()][obj->getY()] = 32;
   		}// сняряд не должен ломать все стены подряд!!!!!!!!!!!!
   		if (player.bull.size() > 20){
   	        for (Bullet* obj:player.bull) {
   	        	Map[obj->getX()][obj->getY()] = 32;
   	        	delete obj;
   	        }
   	        player.bull.clear();
   	        }
   	}
//  	  Map[player.getX()][width-1] = 21;
   	for (int i = 0; i < height; ++i, std::cout << std::endl)
   	    for (int j = 0; j < width; ++j)
   	        std::cout << static_cast<char>(Map[i][j]);
}

void MainMap::SwapMap(){
    memcpy(Map, StartMap, sizeof(StartMap));
}
